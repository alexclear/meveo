<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j" xmlns:hftl="http://hftl.org"
	xmlns:hf="http://java.sun.com/jsf/composite/tags"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:p="http://primefaces.org/ui" template="/layout/template.xhtml">

	<ui:define name="navigation">
		<ui:include src="/layout/navigation.xhtml" />
	</ui:define>

	<ui:define name="body">

		<hftl:entityPopup id="searchCounterTemplatePopup"
			header="#{messages['counterTemplate.title']}"
			updateField=":webHookForm:formId:counterTemplateSelectedId:counterTemplateSelectedId"
			selection="#{webHookBean.entity.counterTemplate}"
			backingBean="#{counterTemplateBean}"
			searchField1Label="#{messages['businessEntity.code']}"
			searchField1="code" column1Label="#{messages['businessEntity.code']}"
			column1="code"
			column2Label="#{messages['businessEntity.description']}"
			column2="description"
			dataModel="#{counterTemplateBean.getLazyDataModel('NOTIFICATION')}">
		</hftl:entityPopup>

		<hf:formPanel id="webHookForm" label="#{messages['menu.webHook']}"
			backingBean="#{webHookBean}" columns="4" showEnableDisableButton="true">

			<hf:formField label="#{messages['entity.code']}" field="code"
				required="true" maxLength="60" />
			<hf:formField
				label="#{messages['entity.notification.classNameFilter']}"
				field="classNameFilter" required="true" size="100" maxlength="255" />
			<hf:formField
				label="#{messages['entity.notification.eventTypeFilter']}"
				field="eventTypeFilter" required="true" />
			<hf:formField label="#{messages['entity.notification.elFilter']}"
				field="elFilter" textArea="true" maxlength="1000" />
			<hf:formField label="#{messages['enableEntity.disabled']}"
				field="disabled" isMessage="true" showOnlyOnConsult="true"/>
			<hf:formField label="#{messages['entity.notification.elAction']}"
				field="elAction" textArea="true" maxlength="2000" />
			<hf:formField label="#{messages['entity.webHook.host']}" field="host"
				required="true" size="100" maxlength="255" />
			<hf:formField label="#{messages['entity.webHook.port']}" field="port" />
			<hf:formField label="#{messages['entity.webHook.page']}" field="page"
				size="100" maxlength="255" required="true" />
			<hf:formField label="#{messages['entity.webHook.httpMethod']}"
				field="httpMethod" required="true" />
			<hf:formField label="#{messages['entity.webHook.username']}"
				field="username" size="50" maxlength="255" />
			<hf:formField label="#{messages['entity.webHook.password']}"
				field="password" size="50" maxlength="255" />

			<hf:formField label="#{messages['entity.webHook.headers']}"
				field="headers" />
			<hf:formField label="#{messages['entity.webHook.params']}"
				field="params" />

			<hf:formEntityField id="counterTemplateSelectedId"
				label="#{messages['counterTemplate.title']}" field="counterTemplate"
				childField="code" popup="true" popupId="searchCounterTemplatePopup"
				clearButton="true" required="false" />
		</hf:formPanel>

		<p:panel rendered="#{!webHookBean.edit}">
			<hftl:dataList backingBean="#{notificationHistoryBean}" checkMany="false"
				dataModel="#{notificationHistoryBean.getLazyDataModel(webHookBean.entity.id)}">
				<hftl:column label="#{messages['commons.date']}" field="auditable"
					childField="updated" isDate="true" time="true" />
				<hftl:column
					label="#{messages['entity.notification.notificationType']}"
					field="entityClassName" />
				<hftl:column label="#{messages['entity.notification']}"
					field="notification" childField="code" />
				<hftl:column label="#{messages['entity.notification.retryNr']}"
					field="nbRetry" />
				<hftl:column label="#{messages['entity.notification.result']}"
					field="result" />
				<p:column
					headerText="#{messages['entity.notification.inboundRequest']}">
					<h:link value="#{entity.inboundRequest.code}"
						outcome="inboundRequestDetail"
						rendered="#{entity.inboundRequest != null}">
						<f:param name="objectId" value="#{entity.inboundRequest.id}" />
					</h:link>
				</p:column>
				<hftl:column label="#{messages['commons.status']}" field="status"
					childField="label" isMessage="true" />
			</hftl:dataList>
		</p:panel>

	</ui:define>

</ui:composition>
